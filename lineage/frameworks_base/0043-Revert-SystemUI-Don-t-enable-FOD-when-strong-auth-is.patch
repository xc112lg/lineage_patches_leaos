From 992f845f9fdb6d215f4b85e670166d9adbf11fd9 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Sun, 19 Sep 2021 19:39:02 +0000
Subject: [PATCH 43/52] Revert "SystemUI: Don't enable FOD when strong auth is
 required"

This reverts commit 0c29b0278b722cf531a55795de78dcad969c1b8a.
---
 .../src/com/android/keyguard/KeyguardUpdateMonitor.java  | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

diff --git a/packages/SystemUI/src/com/android/keyguard/KeyguardUpdateMonitor.java b/packages/SystemUI/src/com/android/keyguard/KeyguardUpdateMonitor.java
index 8fb75f1ac60..78b0fd5be0f 100644
--- a/packages/SystemUI/src/com/android/keyguard/KeyguardUpdateMonitor.java
+++ b/packages/SystemUI/src/com/android/keyguard/KeyguardUpdateMonitor.java
@@ -108,8 +108,6 @@ import com.android.systemui.util.RingerModeTracker;
 
 import com.google.android.collect.Lists;
 
-import lineageos.app.LineageContextConstants;
-
 import java.io.FileDescriptor;
 import java.io.PrintWriter;
 import java.lang.ref.WeakReference;
@@ -324,7 +322,6 @@ public class KeyguardUpdateMonitor implements TrustManager.TrustListener, Dumpab
     };
 
     private final Handler mHandler;
-    private final boolean mHasFod;
 
     private final Observer<Integer> mRingerModeObserver = new Observer<Integer>() {
         @Override
@@ -1747,9 +1744,6 @@ public class KeyguardUpdateMonitor implements TrustManager.TrustListener, Dumpab
             }
         };
 
-        mHasFod = mContext.getPackageManager().hasSystemFeature(
-                LineageContextConstants.Features.FOD);
-
         // Since device can't be un-provisioned, we only need to register a content observer
         // to update mDeviceProvisioned when we are...
         if (!mDeviceProvisioned) {
@@ -1918,8 +1912,7 @@ public class KeyguardUpdateMonitor implements TrustManager.TrustListener, Dumpab
             return;
         }
         mHandler.removeCallbacks(mRetryFingerprintAuthentication);
-        boolean hideFodForStrongAuth = mHasFod && userNeedsStrongAuth();
-        boolean shouldListenForFingerprint = !hideFodForStrongAuth && shouldListenForFingerprint();
+        boolean shouldListenForFingerprint = shouldListenForFingerprint();
         boolean runningOrRestarting = mFingerprintRunningState == BIOMETRIC_STATE_RUNNING
                 || mFingerprintRunningState == BIOMETRIC_STATE_CANCELLING_RESTARTING;
         if (runningOrRestarting && !shouldListenForFingerprint) {
-- 
2.30.2

