From 4167fd2a5b2384980626db3da843330ecb398345 Mon Sep 17 00:00:00 2001
From: Victor Bo <bvoid@yandex.ru>
Date: Sun, 19 Sep 2021 18:57:26 +0000
Subject: [PATCH 10/52] Revert "FODCircleView: Extend use of
 mIsBiometricRunning"

This reverts commit 9e2f37fd0134bb894175c68b92726af62734d647.
---
 .../android/systemui/biometrics/FODCircleView.java   | 12 ++++++++----
 1 file changed, 8 insertions(+), 4 deletions(-)

diff --git a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
index fdc18c53d2a..0ba36ed00f7 100644
--- a/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
+++ b/packages/SystemUI/src/com/android/systemui/biometrics/FODCircleView.java
@@ -221,9 +221,11 @@ public class FODCircleView extends ImageView implements TunerService.Tunable {
             mIsDreaming = dreaming;
             updateAlpha();
 
-            if (mIsKeyguard && mIsBiometricRunning) {
+            if (mIsKeyguard && mUpdateMonitor.isFingerprintDetectionRunning()) {
                 show();
                 updateAlpha();
+            } else {
+                hide();
             }
 
             if (dreaming) {
@@ -250,12 +252,14 @@ public class FODCircleView extends ImageView implements TunerService.Tunable {
         @Override
         public void onKeyguardBouncerChanged(boolean isBouncer) {
             mIsBouncer = isBouncer;
-            if (mIsBiometricRunning) {
+            if (mUpdateMonitor.isFingerprintDetectionRunning()) {
                 if (isPinOrPattern(mUpdateMonitor.getCurrentUser()) || !isBouncer) {
                     show();
                 } else {
                     hide();
                 }
+            } else {
+                hide();
             }
         }
 
@@ -271,14 +275,14 @@ public class FODCircleView extends ImageView implements TunerService.Tunable {
 
         @Override
         public void onStartedWakingUp() {
-            if (mIsBiometricRunning) {
+            if (mUpdateMonitor.isFingerprintDetectionRunning()) {
                 show();
             }
         }
 
         @Override
         public void onScreenTurnedOn() {
-            if (mIsBiometricRunning && !mFodGestureEnable) {
+            if (mUpdateMonitor.isFingerprintDetectionRunning() && !mFodGestureEnable) {
                 show();
             } else if (mFodGestureEnable && mPressPending) {
                 mHandler.post(() -> showCircle());
-- 
2.30.2

